<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Quality Report - MateCat</title>
    <meta name="description" content="Matecat allows you to get more matches than any other CAT tool."/>
    <meta name="viewport" content="width=device-width"/>
    <link href="${basepath}public/css/build/common.css?build=${build_number}" rel="stylesheet" type="text/css" />
    <link href="${basepath}public/css/build/style.css?build=${build_number}" rel="stylesheet" type="text/css" />
    <link href="${basepath}public/css/build/semantic.css?build=${build_number}" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="${basepath}public/css/build/legacy-misc.css?build=${build_number}"/>

    <script type="text/javascript">
        var config = {
            basepath: '${basepath | string:/}',
            id_job: '${job/id}',
            password: '${job/password}',
            version_number: ${version_number | string: null},
            is_pass : ${is_pass},
            score : '${score}'
        };
    </script>
    <script type="text/javascript" src="${basepath}public/js/build/libs.js?build=${build_number}"></script>
    <script type="text/javascript" src="${basepath}public/js/build/common.js?build=${build_number}"></script>

    <script src="${basepath}public/js/build/react.js?build=${build_number}"></script>
    <script src="${basepath}public/js/build/cat-react.js?build=${build_number}"></script>
    <script type="text/javascript" src="${basepath}public/js/build/qa-report-improved.js?build=${build_number}"></script>
    <style>
        header {
            box-sizing: initial;
        }

        #quality-report-select {
            float: right;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        #report-versions-select {
            min-width: 500px;
            background-color: #d7d7d7;
        }

        #report-versions-select > .text {
            background: none !important;
            box-shadow: none !important;
            position: initial !important;
        }

        #report-versions-select .report-item,
        #report-versions-select > .text {
            font-size: 15px;
            font-weight: bold;
            line-height: 15px;
            min-height: 37px;
        }

        .report-item .version-green,
        .report-item .version-red,
        #report-versions-select > .text .version-green,
        #report-versions-select > .text .version-red{
            position: absolute;
            width: 10px;
            top: -1px;
            height: 37px;
            left: -1px;
            background-color: green;
        }

        .report-item .version-red,
        #report-versions-select > .text .version-red{
            background-color: red;
        }

        #report-versions-select .report-date {
            float: right !important;
            color: grey;
            font-size: 13px;
            float: right;
            margin-top: 0px;
        }

        #report-versions-select .report-text {
            float: left;
        }

        .onoffswitch-drive {
            zoom: 0.65;
        }

        .project_name_subtitle {
            font-size: 36px;
            font-weight: bold;
        }

        .quality_report_header {
            margin: 0 0 20px 0 ;
        }

    </style>
</head>

<body class="improved-reviselog">

<header>
    <div class="wrapper">

        <div class="logo-menu">
            <a href="${basepath}" class="logo">
            </a>
        </div> <!-- .logo-menu -->

        <div class="action-menu">
            <div id="action-back-to-translate" title="Back to translate">
                <a tal:attributes="href back_url"  class="downloadtr-button btn-main" >${back_label}</a>
            </div>
            <div id="action-download-report" title="Download this report">
                <a tal:attributes="href download_uri"  class="downloadtr-button btn-main">Download this report</a>
            </div>
        </div>  <!-- .action-menu -->

        <div class="profile-menu">
            <div class="column-separator"></div>
            <div tal:condition="isLoggedIn" title="Manage" id="action-manage">
                <a href="/manage" class="action-submenu" >
                    <svg width="36px" height="36px" viewBox="0 0 42 42" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <defs>
                            <polygon id="path-1" points="0 -0.0002 21 -0.0002 21 21 0 21"/>
                            <polygon id="path-3" points="0 0.323 3.9997 0.323 3.9997 4.3226 0 4.3226"/>
                            <polygon id="path-5" points="0 0.1166 3.9997 0.1166 3.9997 4.1166 0 4.1166"/>
                            <polygon id="path-7" points="0 0.0004 3.9997 0.0004 3.9997 4.0004 0 4.0004"/>
                        </defs>
                        <g id="icon-manage" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <g id="Group-19" transform="translate(2.000000, 9.000000)">
                                <path d="M22.5,9.7771 C22.5,9.1771 22.1,8.7771 21.5,8.7771 L9,8.7771 C8.4,8.7771 8,9.1771 8,9.7771 C8,10.3771 8.4,10.7771 9,10.7771 L21.5,10.7771 C22.1,10.7771 22.5,10.3771 22.5,9.7771" id="Fill-1" fill="#FFFFFF"/>
                                <path d="M9,3.6775 L23,3.6775 C23.6,3.6775 24,3.2775 24,2.6775 C24,2.0765 23.6,1.6775 23,1.6775 L9,1.6775 C8.4,1.6775 8,2.0765 8,2.6775 C8,3.2775 8.4,3.6775 9,3.6775" id="Fill-3" fill="#FFFFFF"/>
                                <path d="M9,15.6775 C8.4,15.6775 8,16.0765 8,16.6775 C8,17.2775 8.4,17.6775 9,17.6775 L15,17.6775 C15.6,17.6775 16,17.2775 16,16.6775 C16,16.0765 15.6,15.6775 15,15.6775 L9,15.6775 Z" id="Fill-5" fill="#FFFFFF"/>
                                <g id="Group-9" transform="translate(17.000000, 2.677100)">
                                    <mask id="mask-2" fill="white">
                                        <use xlink:href="#path-1"></use>
                                    </mask>
                                    <g id="Clip-8"></g>
                                    <path d="M2,17.3998 L17,2.3998 L18.6,4.0008 L3.6,19.0008 L2,19.0008 L2,17.3998 Z M1,21.0008 L4,21.0008 C4.3,21.0008 4.5,20.8998 4.7,20.6998 L20.7,4.6998 C21.1,4.2998 21.1,3.6998 20.7,3.2998 L17.7,0.2998 C17.3,-0.1002 16.7,-0.1002 16.3,0.2998 L0.3,16.2998 C0.1,16.5008 0,16.6998 0,17.0008 L0,20.0008 C0,20.5998 0.4,21.0008 1,21.0008 L1,21.0008 Z" id="Fill-7" fill="#FFFFFF" mask="url(#mask-2)"></path>
                                </g>
                                <g id="Group-12" transform="translate(0.000000, 0.677100)">
                                    <mask id="mask-4" fill="white">
                                        <use xlink:href="#path-3"></use>
                                    </mask>
                                    <g id="Clip-11"></g>
                                    <path d="M1.0347,4.3226 L2.9657,4.3226 C3.5367,4.3226 3.9997,3.8596 3.9997,3.2886 L3.9997,1.3576 C3.9997,0.7856 3.5367,0.3226 2.9657,0.3226 L1.0347,0.3226 C0.4637,0.3226 -0.0003,0.7856 -0.0003,1.3576 L-0.0003,3.2886 C-0.0003,3.8596 0.4637,4.3226 1.0347,4.3226" id="Fill-10" fill="#FFFFFF" mask="url(#mask-4)"></path>
                                </g>
                                <g id="Group-15" transform="translate(0.000000, 7.677100)">
                                    <mask id="mask-6" fill="white">
                                        <use xlink:href="#path-5"></use>
                                    </mask>
                                    <g id="Clip-14"></g>
                                    <path d="M1.0347,4.1166 L2.9657,4.1166 C3.5367,4.1166 3.9997,3.6536 3.9997,3.0826 L3.9997,1.1506 C3.9997,0.5796 3.5367,0.1166 2.9657,0.1166 L1.0347,0.1166 C0.4637,0.1166 -0.0003,0.5796 -0.0003,1.1506 L-0.0003,3.0826 C-0.0003,3.6536 0.4637,4.1166 1.0347,4.1166" id="Fill-13" fill="#FFFFFF" mask="url(#mask-6)"></path>
                                </g>
                                <g id="Group-18" transform="translate(0.000000, 14.677100)">
                                    <mask id="mask-8" fill="white">
                                        <use xlink:href="#path-7"></use>
                                    </mask>
                                    <g id="Clip-17"></g>
                                    <path d="M1.0347,4.0004 L2.9657,4.0004 C3.5367,4.0004 3.9997,3.5364 3.9997,2.9654 L3.9997,1.0344 C3.9997,0.4634 3.5367,0.0004 2.9657,0.0004 L1.0347,0.0004 C0.4637,0.0004 -0.0003,0.4634 -0.0003,1.0344 L-0.0003,2.9654 C-0.0003,3.5364 0.4637,4.0004 1.0347,4.0004" id="Fill-16" fill="#FFFFFF" mask="url(#mask-8)"></path>
                                </g>
                            </g>
                        </g>
                    </svg>
                </a>
            </div>
            <div metal:use-macro="${php: INIT::$TEMPLATE_ROOT}/common.html/login_includes" />
        </div> <!-- .profile-menu -->
    </div>
</header>

<div class="wrapper" style="margin-top: 38px; margin-bottom: 50px;">

    <div class="quality_report_header">

        <div style="float: left;">
            <h1 >Quality Report </h1>
            <div class="project_name_subtitle">Project: <span id="pname" tal:content="project/name"></span></div>
        </div>

        <div id="quality-report-select"></div>

        <div class="clear"></div>
    </div>


    <table class="tablestats left-aligned" border="0" cellpadding="0" cellspacing="0">
        <tr>
            <th>Project number</th>
            <td><span tal:content="model/project/id"></span></td>

            <th>Total source words count</th>
            <td><span tal:content="model/project/metadata/total_source_words | default"></span></td>

            <th>Report date</th>
            <td><span>${current_date}</span></td>
        </tr>
        <tr>
            <th>Creation date</th>
            <td><span tal:content="model/project/created_at | default"></span></td>

            <th>Language pair</th>
            <td><span tal:content="model/job/source"></span> - <span tal:content="model/job/target"></span></td>

            <th>Vendor</th>
            <td><span tal:content="model/project/metadata/vendor | default"></span></td>
        </tr>

        <tr>
            <th>Percentage reviewed</th>
            <td><span tal:content="model/chunk/review/percentage | default"></span>%</td>

            <th>Pass/Fail</th>
            <td>
                <strong tal:condition="true: model/chunk/review/is_pass" class="approved-foreground">PASS</strong>
                <strong tal:condition="not: model/chunk/review/is_pass" class="rejected-foreground">FAIL</strong>
            </td>

            <th>Score</th>
            <td><span tal:content="model/chunk/review/score"></span></td>
        </tr>

        <tr>
            <th>Reviewer name</th>
            <td colspan="1" tal:content="model/chunk/review/reviewer_name"></td>

            <th>Avg. Edit distance</th>
            <td colspan="1" tal:content="model/chunk/avg_edit_distance"></td>

            <th>Avg. Time to edit name</th>
            <td colspan="1" tal:content="model/chunk/avg_time_to_edit"></td>
        </tr>
    </table>

    <div style="margin-bottom: 20px;" tal:repeat="file model/chunk/files">
        <h2>File name: <span tal:content="file/filename"></span></h2>

        <div style="margin-bottom: 30px" tal:repeat="segment file/segments">

            <table class="tablestats continue left-aligned" width="100%" border="0" cellspacing="0" cellpadding="0">
                <colgroup>
                    <col width="100px" />
                    <col width="100px" />
                    <col width="150px" />
                </colgroup>
                <tr>
                    <th colspan="1">Segment ID</th>
                    <td colspan="1">
                        <a target="_blank" href="${segment/translate_url}">${segment/id}</a>
                    </td>

                    <th>Source</th>
                    <td style="text-align: left;" tal:content="segment/source"></td>

                </tr>
                <tr>
                    <th>Status</th>
                    <td>
                        <strong class="approved-foreground" tal:condition="true: segment/is_approved" tal:content="segment/status"></strong>
                        <strong class="rejected-foreground" tal:condition="true: segment/is_rejected" tal:content="segment/status"></strong>
                        <strong class="" tal:condition="true: segment/is_translated" tal:content="segment/status"></strong>
                    </td>
                    <th>Post Edited</th>
                    <td style="text-align: left;" tal:content="segment/translation"></td>

                </tr>

                <tr>

                    <th>Edit distance</th>
                    <td tal:content="segment/edit_distance"></td>

                    <th>Original Target</th>
                    <td tal:content="segment/original_translation"></td>
                </tr>

               <tr>
                   <th>Time to edit</th>
                   <td tal:content="segment/time_to_edit"></td>

                   <th></th>
                   <td></td>
               </tr>
            </table>

            <tal:block tal:condition="true: segment/issues">

            <h3>Issues</h3>

            <table class="tablestats continue" width="100%" border="0" cellspacing="0" cellpadding="0">
                <tr tal:repeat="issue segment/issues">
                    <th style="vertical-align: top" width="20" tal:content="repeat/issue/number"></th>
                    <td style="text-align:left">
                        <span style="padding-right: 10px; ">
                            <strong>Category:</strong> <span tal:content="issue/category"></span>
                        </span>

                        <span style="padding-right: 10px;">
                            <strong>Severity</strong> <span tal:content="issue/severity"></span>

                        </span>

                        <span style="padding-right: 10px;">
                            <strong>Target text:</strong> <span tal:content="issue/target_text"></span>
                        </span>


                        <tal:block condition="exists: issue/comment">
                            <span style="padding-right: 10px;">
                                <strong>Reviewer comment:</strong> ${issue/comment}
                            </span>
                        </tal:block>

                        <tal:block condition="true: issue/replies_count">

                            <div style="margin: 10px 0;"><strong>Discussion</strong></div>
                            <hr />
                            <div class="">
                                <div style="width: 200px; display:inline; float:left;"><strong>Date</strong></div>
                                <div style="width: 100%; display:inline;"><strong>Comment</strong></div>
                            </div>

                            <div tal:repeat="comment issue/comments">
                                <div style="width: 200px; display:inline; float:left">${comment/created_at}</div>
                                <div style="width: 100%; display: inline;">${comment/comment}</div>
                            </div>

                        </tal:block>
                    </td>
                </tr>

            </table>

            </tal:block>

            <tal:block tal:condition="true: segment/qa_checks">

                <h3>QA Checks</h3>

                <table class="tablestats continue" width="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr tal:repeat="qa_check segment/qa_checks">
                        <th style="vertical-align: top" width="20" tal:content="repeat/qa_check/number"></th>
                        <td style="text-align:left">

                        <span style="padding-right: 10px;">
                            <strong tal:content="qa_check/human_scope"></strong>: <span tal:content="structure qa_check/message"></span>
                        </span>

                        </td>
                    </tr>

                </table>

            </tal:block>
        </div>
    </div>


</div>

<div class="notifications-wrapper"></div>

<footer>
    <div class="wrapper">
        <nav>
            <ul>
                <li>
                    <a href="https://www.matecat.com/support/" target="_blank">Support</a>
                </li>
            </ul>
        </nav>
    </div>
</footer>


<div metal:use-macro="${php: INIT::$TRACKING_CODES_VIEW_PATH}/external_sources.html/track_codes_upload"/>

<div metal:use-macro="${php: INIT::$TEMPLATE_ROOT}/common.html/footer_includes" />

<script>
    <tal:block>
        /*<![CDATA[*/

        function initLogoutAction() {
        $('.user-menu-container').on('click', '#logout-item', function (e) {
            e.preventDefault();
            $.post('/api/app/user/logout', function (data) {
                if ($('body').hasClass('manage')) {
                    location.href = config.hostpath + config.basepath;
                } else {
                    window.location.reload();
                }
            });
        });
    }

        function initProfileModal() {
        $('#profile-item').on('click', function (e) {
            e.preventDefault();
            e.stopPropagation();
            $('#modal').trigger('openpreferences');
            return false;
        });
    }

        function initDropdown() {
        $('#user-menu-dropdown').dropdown();
    }

        $(document).ready(function(){
        initLogoutAction();
        initProfileModal();
        initDropdown();
    });

        /*]]>*/
    </tal:block>
</script>

</body>
</html>